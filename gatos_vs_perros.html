<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GATOS VS PERROS: Guerra Simplificada</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #2c3e50; /* Azul oscuro */
            color: #ecf0f1; /* Blanco hueso */
            text-align: center;
            padding: 20px;
        }
        .game-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #34495e; /* Gris/Azul oscuro */
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.7);
        }
        h1 {
            color: #f1c40f; /* Amarillo */
            border-bottom: 2px solid #f1c40f;
            padding-bottom: 10px;
        }
        /* Estilos espec√≠ficos para la pantalla de inicio */
        #start-screen {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .team-select-button {
            padding: 20px 40px;
            margin: 15px;
            font-size: 1.5em;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .team-select-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }

        /* Estilos del Juego Principal */
        .stats-panel {
            display: flex;
            justify-content: space-around;
            margin-bottom: 25px;
        }
        .team-stats {
            width: 48%;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px #2c3e50;
        }
        #cat-stats { background-color: #3498db; } /* Azul de Gatos */
        #dog-stats { background-color: #e74c3c; } /* Rojo de Perros */
        
        .health-bar {
            background-color: #000;
            margin-top: 5px;
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid #fff;
        }
        .health-fill {
            height: 100%;
            transition: width 0.5s;
        }
        .energy-text {
            font-size: 1.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .actions-panel {
            background-color: #555;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .unit-button {
            padding: 10px 15px;
            margin: 8px;
            cursor: pointer;
            border: 1px solid #fff;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        .unit-button:hover:not(:disabled) {
            opacity: 0.9;
            transform: scale(1.05);
        }
        .cat-unit { background-color: #2980b9; color: #fff; }
        .dog-unit { background-color: #c0392b; color: #fff; }
        .turn-button {
            padding: 15px 30px;
            font-size: 1.2em;
            background-color: #2ecc71; /* Verde */
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            font-weight: bold;
        }
        
        .log-panel {
            background-color: #2c3e50;
            padding: 10px;
            text-align: left;
            height: 150px;
            overflow-y: scroll;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 0.9em;
            border: 1px solid #444;
        }
        .log-entry { margin-bottom: 3px; }
        .cat-log { color: #3498db; }
        .dog-log { color: #e74c3c; }
        .neutral-log { color: #f1c40f; } /* Amarillo para info central */
        
        /* Utilidades */
        .disabled { opacity: 0.5; cursor: not-allowed; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="start-screen" class="game-container">
        <h1>GATOS VS PERROS: Elige tu Bando</h1>
        <p>Selecciona el equipo que quieres liderar contra la IA enemiga:</p>
        <button class="team-select-button" style="background-color: #3498db; color: #fff;" onclick="startGame('cat')">üê± JUGAR COMO GATO</button>
        <button class="team-select-button" style="background-color: #e74c3c; color: #fff;" onclick="startGame('dog')">üê∂ JUGAR COMO PERRO</button>
    </div>

    <div id="main-game" class="game-container hidden">
        <h1>GATOS üê± VS PERROS üê∂: Guerra Simplificada</h1>
        <p>¬°Compra unidades con Energ√≠a (‚ö°) para atacar la Base enemiga!</p>

        <div class="stats-panel">
            <div id="cat-stats" class="team-stats">
                <h2>Equipo Gato</h2>
                <div class="energy-text">Energ√≠a: <span id="cat-energy">5</span> ‚ö°</div>
                <p>Base: <span id="cat-health-text">100</span> HP</p>
                <div class="health-bar"><div id="cat-health-fill" class="health-fill" style="width: 100%; background-color: #3498db;"></div></div>
                <p>Unidades en campo: <span id="cat-units-count">0</span></p>
            </div>

            <div id="dog-stats" class="team-stats">
                <h2>Equipo Perro</h2>
                <div class="energy-text">Energ√≠a: <span id="dog-energy">5</span> ‚ö°</div>
                <p>Base: <span id="dog-health-text">100</span> HP</p>
                <div class="health-bar"><div id="dog-health-fill" class="health-fill" style="width: 100%; background-color: #e74c3c;"></div></div>
                <p>Unidades en campo: <span id="dog-units-count">0</span></p>
            </div>
        </div>

        <div class="actions-panel">
            <h2>ACCIONES</h2>
            <div id="unit-buttons">
                <button class="unit-button cat-unit" data-unit="soldier" data-team="cat" onclick="buyUnit('cat', 'soldier')">Soldado Gato (2 ‚ö° | Atk 2)</button>
                <button class="unit-button cat-unit" data-unit="tank" data-team="cat" onclick="buyUnit('cat', 'tank')">Tanque Gato (5 ‚ö° | Atk 5)</button>
                
                <button class="unit-button dog-unit hidden" data-unit="hound" data-team="dog" onclick="buyUnit('dog', 'hound')">Cazador Perro (2 ‚ö° | Atk 2)</button>
                <button class="unit-button dog-unit hidden" data-unit="brute" data-team="dog" onclick="buyUnit('dog', 'brute')">Bruto Perro (5 ‚ö° | Atk 5)</button>
            </div>
            
            <button id="end-turn-button" class="turn-button" onclick="endTurn()">FINALIZAR TURNO ‚û°Ô∏è</button>
        </div>

        <div id="game-message" class="log-panel">
            <div class="neutral-log log-entry">>> Gana energ√≠a por turno para comprar unidades. ¬°Destruye la base enemiga!</div>
        </div>

        <div id="end-game-screen" class="game-container hidden">
            <h1 id="end-game-message" style="font-size: 3em;"></h1>
            <button class="turn-button" onclick="location.reload()">JUGAR DE NUEVO</button>
        </div>

    </div>

    <script>
        // --- 1. ESTADO GLOBAL ---
        let playerTeam = null;      // 'cat' o 'dog'
        let opponentTeam = null;    // 'dog' o 'cat'

        const UNITS = {
            soldier: { name: 'Gato Soldado', cost: 2, attack: 2 },
            tank: { name: 'Gato Tanque', cost: 5, attack: 5 },
            hound: { name: 'Perro Cazador', cost: 2, attack: 2 },
            brute: { name: 'Perro Bruto', cost: 5, attack: 5 }
        };

        let gameState = {
            cat: { health: 100, energy: 5, units: 0, attackPower: 0 },
            dog: { health: 100, energy: 5, units: 0, attackPower: 0 },
            turn: 'cat', // Se ajusta al iniciar el juego
            energyPerTurn: 2 
        };

        // --- 2. INICIO DEL JUEGO Y UTILIDADES ---

        function startGame(team) {
            playerTeam = team;
            opponentTeam = team === 'cat' ? 'dog' : 'cat';

            // Mostrar el juego principal y ocultar la pantalla de inicio
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('main-game').classList.remove('hidden');

            gameState.turn = playerTeam;
            log(`¬°Has elegido el bando ${playerTeam.toUpperCase()}! El juego comienza.`, 'neutral');
            
            // Ocultar los botones de la unidad de la IA
            document.querySelectorAll(`.unit-button`).forEach(btn => {
                if (btn.getAttribute('data-team') === opponentTeam) {
                    btn.classList.add('hidden');
                }
            });

            updateUI();
        }

        function log(message, type = 'neutral') {
            const logPanel = document.getElementById('game-message');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}-log`;
            entry.textContent = `>> ${message}`;
            logPanel.prepend(entry);
            while (logPanel.children.length > 30) {
                logPanel.removeChild(logPanel.lastChild);
            }
        }

        function updateUI() {
            // Actualizar Salud, Energ√≠a y Conteo de Unidades
            document.getElementById('cat-health-text').textContent = gameState.cat.health;
            document.getElementById('dog-health-text').textContent = gameState.dog.health;
            document.getElementById('cat-energy').textContent = gameState.cat.energy;
            document.getElementById('dog-energy').textContent = gameState.dog.energy;
            document.getElementById('cat-units-count').textContent = `${gameState.cat.units} (Total Atk: ${gameState.cat.attackPower})`;
            document.getElementById('dog-units-count').textContent = `${gameState.dog.units} (Total Atk: ${gameState.dog.attackPower})`;

            // Actualizar Barras de Salud
            document.getElementById('cat-health-fill').style.width = `${Math.max(0, gameState.cat.health)}%`;
            document.getElementById('dog-health-fill').style.width = `${Math.max(0, gameState.dog.health)}%`;
            document.getElementById('cat-health-fill').style.backgroundColor = gameState.cat.health > 50 ? '#3498db' : gameState.cat.health > 20 ? '#f1c40f' : '#e74c3c';
            document.getElementById('dog-health-fill').style.backgroundColor = gameState.dog.health > 50 ? '#e74c3c' : gameState.dog.health > 20 ? '#f1c40f' : '#3498db';

            // Actualizar t√≠tulos de equipo para reflejar qui√©n es el jugador
            document.getElementById('cat-stats').querySelector('h2').textContent = `Equipo Gato${playerTeam === 'cat' ? ' (T√∫)' : ' (IA)'}`;
            document.getElementById('dog-stats').querySelector('h2').textContent = `Equipo Perro${playerTeam === 'dog' ? ' (T√∫)' : ' (IA)'}`;


            // Actualizar Botones de Acci√≥n (Solo los del jugador)
            const isPlayerTurn = gameState.turn === playerTeam;
            document.querySelector('.actions-panel h2').textContent = `ACCIONES (Turno: ${gameState.turn.toUpperCase()})`;

            document.querySelectorAll('.unit-button').forEach(button => {
                const team = button.getAttribute('data-team');
                const unitType = button.getAttribute('data-unit');
                const unit = UNITS[unitType];
                
                if (team === playerTeam) {
                    const isDisabled = gameState[playerTeam].energy < unit.cost || !isPlayerTurn;
                    button.disabled = isDisabled;
                    button.classList.toggle('disabled', isDisabled);
                }
            });
            
            document.getElementById('end-turn-button').disabled = !isPlayerTurn;
            document.getElementById('end-turn-button').classList.toggle('disabled', !isPlayerTurn);

            checkGameOver();
        }

        function checkGameOver() {
            let message = '';
            if (gameState.dog.health <= 0) {
                message = gameState.turn === 'cat' ? '¬°VICTORIA! üèÜ Los Gatos destruyeron la base Perro.' : '¬°DERROTA! üòû La base Gato cay√≥.';
            } else if (gameState.cat.health <= 0) {
                message = gameState.turn === 'dog' ? '¬°VICTORIA! üèÜ Los Perros destruyeron la base Gato.' : '¬°DERROTA! üòû La base Perro cay√≥.';
            }

            if (message) {
                document.getElementById('end-game-message').textContent = message;
                document.getElementById('main-game').classList.add('hidden');
                document.getElementById('end-game-screen').classList.remove('hidden');
                return true;
            }
            return false;
        }

        // --- 3. FUNCIONES DE JUEGO ---

        function buyUnit(team, unitType) {
            // Solo se pueden comprar unidades si es el turno del jugador
            if (team !== playerTeam || gameState.turn !== playerTeam) return; 

            const unitData = UNITS[unitType];
            const currentTeam = gameState[team];
            
            if (currentTeam.energy >= unitData.cost) {
                currentTeam.energy -= unitData.cost;
                currentTeam.units += 1;
                currentTeam.attackPower += unitData.attack;
                
                log(`${team === 'cat' ? 'üê± Gato' : 'üê∂ Perro'} despliega un ${unitData.name} (Atk ${unitData.attack}).`, team);
                updateUI();
            } else {
                log('Energ√≠a insuficiente para esa unidad.', team);
            }
        }
        
        // Funci√≥n de compra exclusiva para la IA
        function buyAIUnit(team, unitType) {
            const unitData = UNITS[unitType];
            const currentTeam = gameState[team];
            
            if (currentTeam.energy >= unitData.cost) {
                currentTeam.energy -= unitData.cost;
                currentTeam.units += 1;
                currentTeam.attackPower += unitData.attack;
                
                log(`${team === 'cat' ? 'üê± Gato' : 'üê∂ Perro'} despliega un ${unitData.name} (Atk ${unitData.attack}).`, team);
            }
        }

        function performBattle() {
            const cat = gameState.cat;
            const dog = gameState.dog;

            // 1. Simular p√©rdidas de unidades (basado en el poder de ataque)
            
            // Ataque del Gato contra Unidades Perro
            const catSurplusAttack = Math.max(0, cat.attackPower - dog.units);
            let unitsLostDog = Math.min(dog.units, catSurplusAttack > 0 ? Math.ceil(catSurplusAttack / 2) : 0);
            
            // Ataque del Perro contra Unidades Gato
            const dogSurplusAttack = Math.max(0, dog.attackPower - cat.units);
            let unitsLostCat = Math.min(cat.units, dogSurplusAttack > 0 ? Math.ceil(dogSurplusAttack / 2) : 0);
            
            // 2. Aplicar p√©rdidas de unidades
            if (unitsLostCat > 0) log(`üê∂ El poder Perro neutraliza ${unitsLostCat} unidades Gato.`, 'dog');
            if (unitsLostDog > 0) log(`üê± El poder Gato neutraliza ${unitsLostDog} unidades Perro.`, 'cat');

            cat.units -= unitsLostCat;
            dog.units -= unitsLostDog;
            
            // 3. Recalcular poder de ataque (de las unidades restantes)
            cat.attackPower = cat.units * (UNITS.soldier.attack);
            dog.attackPower = dog.units * (UNITS.hound.attack);
            
            // 4. Ataque a Base: Si las unidades restantes son m√°s, atacan la base.
            const catBaseAttack = Math.max(0, cat.units - dog.units);
            const dogBaseAttack = Math.max(0, dog.units - cat.units);
            
            if (catBaseAttack > 0) {
                const damage = catBaseAttack * 3; 
                dog.health -= damage;
                log(`¬°ATAQUE A BASE! üê± ${catBaseAttack} unidades Gato atacan la Base Perro por ${damage} de da√±o.`, 'cat');
            } else if (dogBaseAttack > 0) {
                const damage = dogBaseAttack * 3;
                cat.health -= damage;
                log(`¬°ATAQUE A BASE! üê∂ ${dogBaseAttack} unidades Perro atacan la Base Gato por ${damage} de da√±o.`, 'dog');
            }
        }
        
        function opponentAITurn() {
            if (checkGameOver()) return;
            
            log(`Turno de la IA (${opponentTeam.toUpperCase()})...`, opponentTeam);
            
            const opponent = gameState[opponentTeam];
            const player = gameState[playerTeam];
            
            // 1. Ganar Energ√≠a
            opponent.energy += gameState.energyPerTurn;
            log(`${opponentTeam === 'cat' ? 'üê± Gato' : 'üê∂ Perro'} gana ${gameState.energyPerTurn} ‚ö°. Total: ${opponent.energy}`, opponentTeam);
            
            // 2. Comprar unidades (Estrategia: Prioriza la unidad fuerte si el jugador tiene m√°s unidades)
            const basicUnitType = opponentTeam === 'cat' ? 'soldier' : 'hound';
            const heavyUnitType = opponentTeam === 'cat' ? 'tank' : 'brute';
            
            const wantsHeavy = opponent.energy >= UNITS[heavyUnitType].cost && player.units > opponent.units;

            if (wantsHeavy) {
                buyAIUnit(opponentTeam, heavyUnitType);
            } else if (opponent.energy >= UNITS[basicUnitType].cost) {
                // Si no, siempre compra la unidad m√°s barata para defender
                buyAIUnit(opponentTeam, basicUnitType);
            }
            
            // 3. Batalla y Siguiente Turno
            performBattle();
            gameState.turn = playerTeam;
            log('Tu turno. ¬°Compra unidades y Finaliza el Turno!', 'neutral');
            updateUI();
        }


        function endTurn() {
            if (gameState.turn !== playerTeam) return;

            // 1. Ganar Energ√≠a (Jugador)
            gameState[playerTeam].energy += gameState.energyPerTurn;
            log(`${playerTeam === 'cat' ? 'üê± Gato' : 'üê∂ Perro'} gana ${gameState.energyPerTurn} ‚ö°. Total: ${gameState[playerTeam].energy}`, playerTeam);

            // 2. Batalla
            performBattle();

            // 3. Cambiar el turno a Oponente (IA)
            gameState.turn = opponentTeam;
            updateUI();

            // 4. Iniciar el turno de la IA despu√©s de un breve retardo
            setTimeout(opponentAITurn, 1500); 
        }

        // --- 4. INICIO DEL JUEGO: Espera la elecci√≥n del usuario ---
        // El juego comienza con la pantalla de selecci√≥n gracias al HTML.
    </script>
</body>
</html>

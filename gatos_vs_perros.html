<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GATOS VS PERROS: Guerra por el Dominio</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #333;
            color: #fff;
            text-align: center;
            padding: 20px;
        }
        .game-container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #222;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        h1 {
            color: #ffcc00; /* Dorado/Amarillo */
            border-bottom: 2px solid #ffcc00;
            padding-bottom: 10px;
        }
        .stats-panel, .actions-panel, .battlefield {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
        }
        .stats-panel {
            display: flex;
            justify-content: space-around;
            background-color: #444;
        }
        .team-stats {
            width: 45%;
            padding: 10px;
            border-radius: 5px;
        }
        #cat-stats { background-color: #1a2a47; border: 2px solid #5a9fff; } /* Azul de Gatos */
        #dog-stats { background-color: #471a1a; border: 2px solid #ff5a5a; } /* Rojo de Perros */
        
        .health-bar {
            background-color: #000;
            border: 1px solid #fff;
            margin-top: 5px;
            height: 15px;
            border-radius: 5px;
            overflow: hidden;
        }
        .health-fill {
            height: 100%;
            transition: width 0.5s;
        }

        .actions-panel {
            background-color: #555;
        }
        .unit-button {
            padding: 10px 15px;
            margin: 5px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        .unit-button:hover:not(:disabled) {
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        .cat-unit { background-color: #5a9fff; color: #1a2a47; }
        .dog-unit { background-color: #ff5a5a; color: #471a1a; }
        .turn-button {
            padding: 15px 30px;
            font-size: 1.2em;
            background-color: #00cc66;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
        }
        
        .battlefield {
            background-color: #333;
            min-height: 100px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .log-panel {
            background-color: #111;
            padding: 10px;
            text-align: left;
            height: 150px;
            overflow-y: scroll;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 0.9em;
        }
        .log-entry {
            margin-bottom: 3px;
        }
        .cat-log { color: #5a9fff; }
        .dog-log { color: #ff5a5a; }
        .neutral-log { color: #ccc; }
        
        /* Estilos de Estado */
        .disabled { opacity: 0.5; cursor: not-allowed; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="game-container">
        <h1>GATOS üê± VS PERROS üê∂: Guerra por el Dominio</h1>
        <p>¬°El objetivo es destruir la base enemiga!</p>

        <div class="stats-panel">
            <div id="cat-stats" class="team-stats">
                <h2>Equipo Gato</h2>
                <p>Base: <span id="cat-health-text">100</span> HP</p>
                <div class="health-bar"><div id="cat-health-fill" class="health-fill" style="width: 100%; background-color: #5a9fff;"></div></div>
                <p>Energ√≠a: <span id="cat-energy">5</span> ‚ö°</p>
                <p>Unidades en campo: <span id="cat-units-count">0</span></p>
            </div>

            <div id="dog-stats" class="team-stats">
                <h2>Equipo Perro</h2>
                <p>Base: <span id="dog-health-text">100</span> HP</p>
                <div class="health-bar"><div id="dog-health-fill" class="health-fill" style="width: 100%; background-color: #ff5a5a;"></div></div>
                <p>Energ√≠a: <span id="dog-energy">5</span> ‚ö°</p>
                <p>Unidades en campo: <span id="dog-units-count">0</span></p>
            </div>
        </div>

        <div class="actions-panel">
            <h2>Acciones (Tu Turno: Gato)</h2>
            <div id="unit-buttons-cat">
                <button class="unit-button cat-unit" data-unit="kitty" onclick="buyUnit('cat', 'kitty')">Gatito (1 ‚ö°)</button>
                <button class="unit-button cat-unit" data-unit="panther" onclick="buyUnit('cat', 'panther')">Pantera (3 ‚ö°)</button>
            </div>
            
            <button id="end-turn-button" class="turn-button" onclick="endTurn()">FINALIZAR TURNO ‚û°Ô∏è</button>
        </div>

        <div class="battlefield">
            </div>

        <div id="game-message" class="log-panel">
            <div class="neutral-log log-entry">>> JUEGO INICIADO. GANA ENERG√çA y COMPRA UNIDADES para destruir la base enemiga.</div>
            <div class="neutral-log log-entry">>> Empiezas t√∫ (GATO).</div>
        </div>

        <div id="end-game-screen" class="game-container hidden">
            <h1 id="end-game-message"></h1>
            <button class="turn-button" onclick="location.reload()">JUGAR DE NUEVO</button>
        </div>

    </div>

    <script>
        // --- 1. DEFINICI√ìN DE UNIDADES Y ESTADO DEL JUEGO ---
        const UNITS = {
            kitty: { name: 'Gatito', cost: 1, attack: 1, hp: 1 },
            panther: { name: 'Pantera', cost: 3, attack: 4, hp: 3 },
            puppy: { name: 'Cachorro', cost: 1, attack: 1, hp: 1 },
            wolf: { name: 'Lobo', cost: 3, attack: 4, hp: 3 }
        };

        let gameState = {
            cat: { health: 100, energy: 5, units: [] },
            dog: { health: 100, energy: 5, units: [] },
            turn: 'cat',
            energyPerTurn: 1 
        };

        // --- 2. FUNCIONES DE UTILIDAD ---
        
        function log(message, type = 'neutral') {
            const logPanel = document.getElementById('game-message');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}-log`;
            entry.textContent = `>> ${message}`;
            logPanel.prepend(entry);
            // Limitar el log a 30 entradas
            while (logPanel.children.length > 30) {
                logPanel.removeChild(logPanel.lastChild);
            }
        }

        function updateUI() {
            // Actualizar Salud de Bases
            document.getElementById('cat-health-text').textContent = gameState.cat.health;
            document.getElementById('dog-health-text').textContent = gameState.dog.health;
            
            // Actualizar Barras de Salud
            document.getElementById('cat-health-fill').style.width = `${gameState.cat.health}%`;
            document.getElementById('dog-health-fill').style.width = `${gameState.dog.health}%`;
            document.getElementById('cat-health-fill').style.backgroundColor = gameState.cat.health > 50 ? '#5a9fff' : gameState.cat.health > 20 ? '#ffcc00' : '#ff0000';
            document.getElementById('dog-health-fill').style.backgroundColor = gameState.dog.health > 50 ? '#ff5a5a' : gameState.dog.health > 20 ? '#ffcc00' : '#ff0000';

            // Actualizar Energ√≠a y Conteo de Unidades
            document.getElementById('cat-energy').textContent = gameState.cat.energy;
            document.getElementById('dog-energy').textContent = gameState.dog.energy;
            document.getElementById('cat-units-count').textContent = gameState.cat.units.length;
            document.getElementById('dog-units-count').textContent = gameState.dog.units.length;

            // Actualizar Acciones y Botones
            const isCatTurn = gameState.turn === 'cat';
            document.querySelector('.actions-panel h2').textContent = `Acciones (Tu Turno: ${isCatTurn ? 'Gato' : 'Perro'})`;
            
            // Deshabilitar botones si no hay energ√≠a suficiente
            document.querySelectorAll('.unit-button').forEach(button => {
                const unitType = button.getAttribute('data-unit');
                const unit = UNITS[unitType];
                const team = button.classList.contains('cat-unit') ? 'cat' : 'dog';
                
                button.disabled = gameState[team].energy < unit.cost || !isCatTurn;
                button.classList.toggle('disabled', button.disabled);
                
                // Ocultar botones de la IA (Perros)
                if (!isCatTurn && button.classList.contains('dog-unit')) {
                    button.classList.add('hidden');
                } else if (isCatTurn && button.classList.contains('cat-unit')) {
                    button.classList.remove('hidden');
                } else if (!isCatTurn && button.classList.contains('cat-unit')) {
                    button.classList.add('hidden');
                } else if (isCatTurn && button.classList.contains('dog-unit')) {
                    button.classList.add('hidden');
                }
            });
            
            document.getElementById('end-turn-button').disabled = !isCatTurn;
            document.getElementById('end-turn-button').classList.toggle('disabled', !isCatTurn);

            checkGameOver();
        }

        function checkGameOver() {
            let message = '';
            if (gameState.dog.health <= 0) {
                message = '¬°VICTORIA! üèÜ La base de los Perros ha sido destruida. Los Gatos dominan.';
            } else if (gameState.cat.health <= 0) {
                message = '¬°DERROTA! üòû La base de los Gatos ha ca√≠do. Los Perros ganan.';
            }

            if (message) {
                document.getElementById('end-game-message').textContent = message;
                document.querySelector('.game-container').classList.add('hidden');
                document.getElementById('end-game-screen').classList.remove('hidden');
                log(message, message.includes('VICTORIA') ? 'cat' : 'dog');
                return true;
            }
            return false;
        }

        // --- 3. FUNCIONES DE JUEGO ---

        function buyUnit(team, unitType) {
            const unitData = UNITS[unitType];
            const currentTeam = gameState[team];
            
            if (currentTeam.energy >= unitData.cost) {
                currentTeam.energy -= unitData.cost;
                
                // Clonar datos de la unidad para que sus HP sean √∫nicos
                const newUnit = { 
                    ...unitData, 
                    currentHp: unitData.hp, 
                    team: team, 
                    name: unitData.name 
                };
                currentTeam.units.push(newUnit);
                
                log(`${team === 'cat' ? 'üê± Gato' : 'üê∂ Perro'} compr√≥: ${unitData.name} por ${unitData.cost} ‚ö°.`, team);
                updateUI();
            } else {
                log('Energ√≠a insuficiente.', team);
            }
        }

        function performBattle() {
            // El combate ocurre entre la unidad m√°s antigua de cada lado (la que est√° "m√°s adelante")
            const catUnits = gameState.cat.units;
            const dogUnits = gameState.dog.units;
            
            let catsDead = [];
            let dogsDead = [];

            if (catUnits.length > 0 && dogUnits.length > 0) {
                // Combate Unidad vs Unidad
                const cat = catUnits[0];
                const dog = dogUnits[0];

                dog.currentHp -= cat.attack;
                cat.currentHp -= dog.attack;
                
                log(`¬°Combate! ${cat.name} ataca a ${dog.name}. ${cat.name} HP: ${cat.currentHp}, ${dog.name} HP: ${dog.currentHp}`, 'neutral');
                
                // Verificar muertes y marcar para eliminar
                if (cat.currentHp <= 0) catsDead.push(cat);
                if (dog.currentHp <= 0) dogsDead.push(dog);

            } else if (catUnits.length > 0) {
                // Ataque a Base Perro
                const cat = catUnits[0];
                gameState.dog.health -= cat.attack;
                log(`¬°ATAQUE A BASE! üê± ${cat.name} ataca la base Perro. Da√±o: ${cat.attack}.`, 'cat');
                
            } else if (dogUnits.length > 0) {
                // Ataque a Base Gato
                const dog = dogUnits[0];
                gameState.cat.health -= dog.attack;
                log(`¬°ATAQUE A BASE! üê∂ ${dog.name} ataca la base Gato. Da√±o: ${dog.attack}.`, 'dog');
            }

            // Eliminar unidades muertas (usamos filter para evitar problemas de √≠ndice)
            gameState.cat.units = gameState.cat.units.filter(unit => !catsDead.includes(unit) && unit.currentHp > 0);
            gameState.dog.units = gameState.dog.units.filter(unit => !dogsDead.includes(unit) && unit.currentHp > 0);
            
            // Log de bajas
            catsDead.forEach(unit => log(`üê± ${unit.name} fue derrotado.`, 'dog'));
            dogsDead.forEach(unit => log(`üê∂ ${unit.name} fue derrotado.`, 'cat'));
        }

        function dogAITurn() {
            if (checkGameOver()) return;
            
            log('Turno de la IA (PERRO) üê∂...', 'dog');
            
            // 1. Ganar Energ√≠a
            gameState.dog.energy += gameState.energyPerTurn;
            log(`üê∂ Perro gana ${gameState.energyPerTurn} ‚ö°. Total: ${gameState.dog.energy}`, 'dog');
            
            // 2. Comprar unidades (Estrategia simple de la IA)
            // Prioriza la unidad m√°s cara si puede pagarla.
            const dogUnits = [UNITS.wolf, UNITS.puppy];
            
            for (let i = 0; i < 2; i++) { // Intenta comprar 2 veces
                if (gameState.dog.energy >= UNITS.wolf.cost) {
                    buyUnit('dog', 'wolf');
                } else if (gameState.dog.energy >= UNITS.puppy.cost) {
                    buyUnit('dog', 'puppy');
                }
            }
            
            // 3. Batalla y Siguiente Turno
            performBattle();
            gameState.turn = 'cat';
            log('Tu turno (GATO).', 'neutral');
            updateUI();
        }


        function endTurn() {
            if (gameState.turn !== 'cat') return;

            // 1. Ganar Energ√≠a (Gato)
            gameState.cat.energy += gameState.energyPerTurn;
            log(`üê± Gato gana ${gameState.energyPerTurn} ‚ö°. Total: ${gameState.cat.energy}`, 'cat');

            // 2. Batalla (antes del turno de la IA)
            performBattle();

            // 3. Cambiar el turno a Perro (IA)
            gameState.turn = 'dog';
            updateUI();

            // 4. Iniciar el turno de la IA despu√©s de un breve retardo
            setTimeout(dogAITurn, 1500); // 1.5s para que el jugador vea lo que pas√≥
        }

        // --- 4. INICIO DEL JUEGO ---
        updateUI();

    </script>
</body>
</html>
